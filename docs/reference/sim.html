<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate Soil Profiles — sim • aqp</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simulate Soil Profiles — sim" />
<meta property="og:description" content="Simulate a collection of soil profiles based on the horizonation of a single soil profile.
The function is most useful when supplied with a meaningful standard deviation in thickness for each horizon -- which generally implies an aggregation of several profiles (say, using some generalized horizon pattern).
This contrasts with a similar approach in permute_profile() -- which &quot;perturbs&quot; the boundary between horizons using a standard deviation of &quot;horizon transition zone&quot; thickness. This thickness standard deviation corresponds roughly to the concept of &quot;horizon boundary distinctness.&quot;" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">aqp</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ncss-tech/aqp/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate Soil Profiles</h1>
    <small class="dont-index">Source: <a href='https://github.com/ncss-tech/aqp/blob/master/R/sim.R'><code>R/sim.R</code></a></small>
    <div class="hidden name"><code>sim.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Simulate a collection of soil profiles based on the horizonation of a single soil profile.</p>
<p>The function is most useful when supplied with a meaningful standard deviation in thickness for each horizon -- which generally implies an aggregation of <strong>several</strong> profiles (say, using some generalized horizon pattern).</p>
<p>This contrasts with a similar approach in <code><a href='permute_profile.html'>permute_profile()</a></code> -- which "perturbs" the <strong>boundary between horizons</strong> using a standard deviation of "horizon transition zone" thickness. This thickness standard deviation corresponds roughly to the concept of "horizon boundary distinctness."</p>
    </div>

    <pre class="usage"><span class='fu'>sim</span><span class='op'>(</span><span class='va'>x</span>, n <span class='op'>=</span> <span class='fl'>1</span>, iterations <span class='op'>=</span> <span class='fl'>25</span>, hz.sd <span class='op'>=</span> <span class='fl'>2</span>, min.thick <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a SoilProfileCollection object containing a single profile from which to draw simulated data</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>the number of requested simulations</p></td>
    </tr>
    <tr>
      <th>iterations</th>
      <td><p>sampling iterations used to determine each horizon thickness</p></td>
    </tr>
    <tr>
      <th>hz.sd</th>
      <td><p>standard deviation used to simulate horizon thickness, can be a vector but must divide evenly into the number of horizons found in <code>x</code></p></td>
    </tr>
    <tr>
      <th>min.thick</th>
      <td><p>minimum horizon thickness allowed in simulation results</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A SoilProfileCollection object with <code>n</code> simulated profiles, each containing the same number of horizons and same data as <code>x</code></p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function generates a collection of simulated soil profiles based on the horizon thickness data associated with a single "template" profile. Simulation is based on sampling from a family of gaussian distribution with means defined by the "template" profile and standard deviation defined by the user.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='random_profile.html'>random_profile</a></code>  <code><a href='permute_profile.html'>permute_profile</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>D. E. Beaudette</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># load sample data and convert into SoilProfileCollection</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>sp3</span><span class='op'>)</span>
<span class='fu'>depths</span><span class='op'>(</span><span class='va'>sp3</span><span class='op'>)</span> <span class='op'>&lt;-</span> <span class='va'>id</span> <span class='op'>~</span> <span class='va'>top</span> <span class='op'>+</span> <span class='va'>bottom</span>

<span class='co'># select a profile to use as the basis for simulation</span>
<span class='va'>s</span> <span class='op'>&lt;-</span> <span class='va'>sp3</span><span class='op'>[</span><span class='fl'>3</span>,<span class='op'>]</span>

<span class='co'># reset horizon names</span>
<span class='va'>s</span><span class='op'>$</span><span class='va'>name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>'H'</span>, <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>s</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span>, sep <span class='op'>=</span> <span class='st'>''</span><span class='op'>)</span>

<span class='co'># simulate 25 new profiles, using 's' and function defaults</span>
<span class='va'>sim.1</span> <span class='op'>&lt;-</span> <span class='fu'>sim</span><span class='op'>(</span><span class='va'>s</span>, n <span class='op'>=</span> <span class='fl'>25</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>converting profile IDs from integer to character</span></div><div class='input'>
<span class='co'># simulate 25 new profiles using 's' and variable SD for each horizon</span>
<span class='va'>sim.2</span> <span class='op'>&lt;-</span> <span class='fu'>sim</span><span class='op'>(</span><span class='va'>s</span>, n <span class='op'>=</span> <span class='fl'>25</span>, hz.sd <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>converting profile IDs from integer to character</span></div><div class='input'>
<span class='co'># plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>, <span class='fl'>1</span><span class='op'>)</span>, mar <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='plotSPC.html'>plot</a></span><span class='op'>(</span><span class='va'>sim.1</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span><span class='op'>(</span>
  <span class='st'>'SD = 2'</span>,
  side <span class='op'>=</span> <span class='fl'>2</span>,
  line <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.5</span>,
  font <span class='op'>=</span> <span class='fl'>2</span>,
  cex <span class='op'>=</span> <span class='fl'>0.75</span>
<span class='op'>)</span>
<span class='fu'><a href='plotSPC.html'>plot</a></span><span class='op'>(</span><span class='va'>sim.2</span><span class='op'>)</span>
</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/mtext.html'>mtext</a></span><span class='op'>(</span>
  <span class='st'>'SD = c(1, 2, 5, 5, 5, 10, 3)'</span>,
  side <span class='op'>=</span> <span class='fl'>2</span>,
  line <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1.5</span>,
  font <span class='op'>=</span> <span class='fl'>2</span>,
  cex <span class='op'>=</span> <span class='fl'>0.75</span>
<span class='op'>)</span>
</div><div class='img'><img src='sim-1.png' alt='' width='768' height='475' /></div><div class='input'>
<span class='co'># aggregate horizonation of simulated data</span>
<span class='co'># note: set class_prob_mode=2 as profiles were not defined to a constant depth</span>
<span class='va'>sim.2</span><span class='op'>$</span><span class='va'>name</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>sim.2</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span>
<span class='va'>a</span> <span class='op'>&lt;-</span> <span class='fu'><a href='slab-methods.html'>slab</a></span><span class='op'>(</span><span class='va'>sim.2</span>, <span class='op'>~</span> <span class='va'>name</span>, class_prob_mode <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>

<span class='co'># convert to long format for plotting simplicity</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://Rdatatable.gitlab.io/data.table'>data.table</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: package 'data.table' was built under R version 4.0.3</span></div><div class='input'><span class='va'>a.long</span> <span class='op'>&lt;-</span>
  <span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html'>melt</a></span><span class='op'>(</span><span class='va'>a</span>,
       id.vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'top'</span>, <span class='st'>'bottom'</span><span class='op'>)</span>,
       measure.vars <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>sim.2</span><span class='op'>$</span><span class='va'>name</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: The melt generic in data.table has been passed a data.frame and will attempt to redirect to the relevant reshape2 method; please note that reshape2 is deprecated, and this redirection is now deprecated as well. To continue using melt methods from reshape2 while both libraries are attached, e.g. melt.list, you can prepend the namespace like reshape2::melt(a). In the next version, this warning will become an error.</span></div><div class='input'>
<span class='co'># plot horizon probabilities derived from simulated data</span>
<span class='co'># dashed lines are the original horizon boundaries</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://lattice.r-forge.r-project.org/'>lattice</a></span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/lattice/man/xyplot.html'>xyplot</a></span><span class='op'>(</span>
  <span class='va'>top</span> <span class='op'>~</span> <span class='va'>value</span>,
  groups <span class='op'>=</span> <span class='va'>variable</span>,
  data <span class='op'>=</span> <span class='va'>a.long</span>,
  subset <span class='op'>=</span> <span class='va'>value</span> <span class='op'>&gt;</span> <span class='fl'>0</span>,
  ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>100</span>,<span class='op'>-</span><span class='fl'>5</span><span class='op'>)</span>,
  type <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'l'</span>, <span class='st'>'g'</span><span class='op'>)</span>,
  asp <span class='op'>=</span> <span class='fl'>1.5</span>,
  ylab <span class='op'>=</span> <span class='st'>'Depth (cm)'</span>,
  xlab <span class='op'>=</span> <span class='st'>'Probability'</span>,
  auto.key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    columns <span class='op'>=</span> <span class='fl'>4</span>,
    lines <span class='op'>=</span> <span class='cn'>TRUE</span>,
    points <span class='op'>=</span> <span class='cn'>FALSE</span>
  <span class='op'>)</span>,
  panel <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span> <span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/pkg/lattice/man/panel.xyplot.html'>panel.xyplot</a></span><span class='op'>(</span><span class='va'>...</span><span class='op'>)</span>
    <span class='fu'><a href='https://rdrr.io/pkg/lattice/man/panel.functions.html'>panel.abline</a></span><span class='op'>(</span>h <span class='op'>=</span> <span class='va'>s</span><span class='op'>$</span><span class='va'>top</span>, lty <span class='op'>=</span> <span class='fl'>2</span>, lwd <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span>
  <span class='op'>}</span>
<span class='op'>)</span>
</div><div class='img'><img src='sim-2.png' alt='' width='768' height='475' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dylan Beaudette, Pierre Roudier, Andrew Brown.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


